<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>logicaCalculadora</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div class="container">

        <div class="div_calculadora">

            <div class="div_orientacoes">

                <div class="texto">

                    <img id="img_tex" class="img-tex" style="display: none;" src="image/view.png">

                <b class="text-tam-b" id="texto_b">

                    Tamanhos de Referência:

                </b>

                <p class="text-tam-p" id="texto_p">

                    Pequeno = Até 50cm <br>
                    Médio = Entre 50cm e 150cm <br>
                    Grande = Acima 150cm <br>

                </p>

                </div>

                <img id="imagem" class="img-ori" src="image/view.png">

                <div class="div_view" id="div_visualizar"></div>
                <div class="div_view_final" id="div_soma" style="display: none;"></div>

            </div>

            <div class="div_componentes">

                <h1> Simule suas Economias </h1> <br>

                <input type="number" class="input_calculadora" id="input_precoObras" placeholder="Preço das Obras"> <br>

                <input type="number" class="input_calculadora" id="input_qtd_obras" placeholder="Quantidade de Obras">
                <br>

                <select id="select_tipo_tinta" class="select_calculadora">

                    <option value="#" selected disabled> Selecione o tipo de tinta </option>
                    <option value="acrilica"> Acrílica</option>
                    <option value="guache"> Guache </option>
                    <option value="oleo"> Óleo</option>

                </select> <br>

                <select id="select_tam_obra" class="select_calculadora">

                    <option value="#" selected disabled> Selecione o tamanho </option>
                    <option value="pequeno"> Pequeno </option>
                    <option value="medio"> Médio </option>
                    <option value="grande"> Grande </option>

                </select> <br>

                <div class="div_botoes">

                    <button onclick="adicionarObra()" class="button_add"> Adicionar </button>
                    <button onclick="calcPrejuizo()" id="botaoCalcular" class="button_calc"
                        style="display: none;">Calcular</button>

                </div>

            </div>

        </div>

    </div>

</body>

</html>

<script>

    let precoTotal = 0;
    let perdaEmRestauracao = 0;

    let numero = 0;

    function adicionarObra() {

        // Variáveis do Valor do precoObras e Quantidade de Obras

        const precoObras = Number(input_precoObras.value);
        const qtdObras = Number(input_qtd_obras.value);

        // Variáveis dos tipos de tintas usadas e dos tamanhos das obras

        precoTotal = precoTotal + precoObras;

        const tipoTinta = select_tipo_tinta.value;
        const tamObra = select_tam_obra.value;

        const validacao = tipoTinta == "#" || tamObra == "#" || precoObras <= 0 || qtdObras <= 0;

        if (validacao) {
            alert(`ERRO: Insira os valores validos`)
        }  else {

            botaoCalcular.style.display = "block";

            let variacaoTam;
            let variacaoTinta;

            if (tamObra == "pequeno") {
                variacaoTam = `Pequeno`
            } else if (tamObra == "medio") {
                variacaoTam = `Médio`
            } else {
                variacaoTam = `Grande`
            }

            if (tipoTinta == "acrilica") {
                variacaoTinta = `Acrílica`
            } else if (tipoTinta == "guache") {
                variacaoTinta = `Guache`
            } else {
                variacaoTinta = `Óleo`
            }

            // Criando variáveis numéricas relacionadas a diferentes tintas e tamanho

            let adicionalTintaAcrilica = 0;
            let adicionalTintaGuache = 0;
            let adicionalTintaOleo = 0;

            let adicionalTamanhoPequeno = 0;
            let adicionalTamanhoMedio = 0;
            let adicionalTamanhoGrande = 0;

            // Calculando quantidade de obras por cada tamanho (MÉDIA)

            const precoUnitarioObras = precoObras / qtdObras

            // Media de preço sobre os tamanhos diversos
            // Acrescentando divisor para tornar o calculo mais preciso

            if (tamObra == "pequeno") {
                adicionalTamanhoPequeno = (precoUnitarioObras * 0.02) + 4000;
            }
            if (tamObra == "medio") {
                adicionalTamanhoMedio = (precoUnitarioObras * 0.035) + 14000;
            }
            if (tamObra == "grande") {
                adicionalTamanhoGrande = (precoUnitarioObras * 0.06) + 20000;
            }
            // Adicional do preco das tintas sobre o valor total da obra

            if (tipoTinta == "acrilica") {
                adicionalTintaAcrilica = precoUnitarioObras * 0.02;
            }
            if (tipoTinta == "guache") {
                adicionalTintaGuache = precoUnitarioObras * 0.02;
            }
            if (tipoTinta == "oleo") {
                adicionalTintaOleo = precoUnitarioObras * 0.02;
            }

            // Multiplicando valores para ter uma média em geral por quantidade de obra com aquele tamanho

            const mediaPorObraTamanhoPequeno = qtdObras * adicionalTamanhoPequeno
            const mediaPorObraTamanhoMedio = qtdObras * adicionalTamanhoMedio
            const mediaPorObraTamanhoGrande = qtdObras * adicionalTamanhoGrande

            // Calculando preço que seria gasto em (MÉDIA) com restauração

            let precoMedioComRestauracao = mediaPorObraTamanhoPequeno + mediaPorObraTamanhoMedio + mediaPorObraTamanhoGrande + adicionalTintaAcrilica + adicionalTintaOleo + adicionalTintaGuache

            // Calculando media do preço de cada obra individualmente

            const preco = precoObras / qtdObras;
            const posRestauracao = precoObras * 0.25

            perdaEmRestauracao = perdaEmRestauracao + precoMedioComRestauracao;

            const porcentagemDeGastoEmRestauracao = ((perdaEmRestauracao * 100) / precoTotal).toFixed(1);

            const precoObrasFormatado = precoObras.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });

            const precoTotalFormatado = precoTotal.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });

            const perdaPatrimonialFormatada = (precoTotal * 0.25).toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });

            numero++;
            
            imagem.style.display = "none";

            div_visualizar.innerHTML += `

            <div id="div_resultado">

                <p>
            
                <b> ${numero} </b> 

                <br> Preço: <b> ${precoObrasFormatado} </b> <br> 

                Quantidade: <b> ${qtdObras} </b> <br> 
                
                Tinta: <b> ${variacaoTinta} </b> <br> 
                
                Tamanho: <b> ${variacaoTam} </b> <br>

                </p>

            </div>
            
            `;

            div_soma.innerHTML = `

                <p>

                <b> Preço total do Acervo: </b> 
                <span style="color: blue"> <b> ${precoTotalFormatado} </b> </span>

                </p>

                <p>

                <br> <b> Perda em restaurações: </b>
                <span style="color: red;"> <b> ${porcentagemDeGastoEmRestauracao}% </b> </span> sobre o valor total do acervo
                
                </p>

                <p>

                <br> <b> Perda patrimonial: </b> Quando suas obras são reparadas, elas perdem cerca de <span style="color: red;"> <b> 25% </b> </span> do seu valor original. O que é equivalente à 
                <span style="color: red;"> <b> ${perdaPatrimonialFormatada} </b> </span>

                </p>

        `;

            // select_tipo_tinta.value = `#`;
            // select_tam_obra.value = `#`;
            // input_qtd_obras.value = ``;
            // input_precoObras.value = ``;

            }}

    function calcPrejuizo() {

        div_visualizar.style.display = "none";
        div_soma.style.display = "block";
        texto_p.style.display = "none";
        texto_b.style.display = "none";
        img_tex.style.display = "block";

    }


</script>