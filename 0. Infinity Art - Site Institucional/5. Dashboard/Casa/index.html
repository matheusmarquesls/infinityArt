<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infinity Art - Dashboard</title>

    <link rel="shortcut icon" href="../../src/img/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="../../src/css/styles - dashboard.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
    <script src="http://www.chartjs.org/dist/2.7.1/Chart.js"></script>
    <script src="http://www.chartjs.org/samples/latest/utils.js"></script>
    
    <script src="https://kit.fontawesome.com/80ec270284.js" crossorigin="anonymous"></script>

</head>

<body>

                <section class="fundo">

                    <div class="dashboard">

                        <div class="dash">

                        <div class="ambiente-atual">

                            <div class="list-endereco">
                         
                                <div class="menu-endereco">
                                    <h1>Casa</h1>
                                    <div class="submenu-amb"><h2>Sala</h2></div>
                                </div>
                           
                                <div class="menu-endereco">
                                    <h1>Galeria</h1>
                                    <div class="submenu-amb"><h2>Exposição 1</h2></div>
                                </div>

                            </div>
                        
                        </div>

                        <div class="distribuicao-elementos">

                            <div class="info-kpi">

                                <div class="title-kpi"> 
                                    <h2>Umidade</h2>
                                <div class="kpi">
                                    <div class="legend" style="color: rgb(73, 209, 73);">
                                    <h1> 2 </h1>
                                    <img src="../../src/img/alertG.png">
                                    </div>
                                    <p> Vezes que atingiu o limite </p>
                                </div>

                                </div>

                                <div class="title-kpi"> 
                                    <h2>Temperatura</h2>
                                <div class="kpi">

                                    <div class="legend" style="color: rgb(242, 210, 3);">
                                    <h1> 4 </h1>
                                    <img src="../../src/img/alertY.png">
                                    </div>
                                    <p> Vezes que atingiu o limite </p>
                                </div>
                                </div>

                                <div class="title-kpi"> 
                                <h2>Luminosidade</h2>
                                <div class="kpi">
                                    <div class="legend" style="color: rgb(237, 83, 72);">
                                    <h1> 9 </h1>
                                    <img src="../../src/img/alertR.png">
                                    </div>
                                    <p> Vezes que atingiu o limite </p>
                                </div>
                            </div>

                                <div class="local">
                                    <h1>Casa</h1>
                                    <hr>
                                    <h1>Sala</h1>
                                </div>

                                <a class="fechar-dash" href="../../3. Ambientes/index.html">
                                <div> X </div>
                                </a>

                            </div>

                            <div class="graficos-dash">

                                <div class="title-grafico">

                                <h1> Temperatura e Umidade do ambiente </h1>
                                <div class="grafico g-sensor">
                                    <canvas id="dht11"></canvas>
                                </div>

                                </div>

                                <!-- Luz -->

                                <div class="title-grafico pizza-lux">

                                <div class="select-estado-css">
                                <h1> Estado / dia </h1> 

                                <select onclick="pizzas()" id="select_estado">
                                    <option value="Lux">Luminosidade</option>
                                    <option value="Temp">Temperatura</option>
                                    <option value="Umi">Umidade</option>
                                </select>
                                </div>
                                <div id="pizza_lux" class="grafico gp-lux">
                                    <canvas id="pizzaLux"></canvas>
                                </div>

                                <div id="pizza_temp" class="grafico gp-temp">
                                    <canvas id="pizzaTemp"></canvas>
                                </div>
                                
                                <div id="pizza_umi" class="grafico gp-umi">
                                    <canvas id="pizzaUmi"></canvas>
                                </div>

                                </div>
    
                                <div class="title-grafico">

                                <h1> Luminosidade do ambiente </h1>
                                <div class="grafico g-sensor">
                                    <canvas id="luminosidade"></canvas>
                                </div>

                                </div>

                                <div class="title-grafico">

                                <h1> Limite atingido / semana </h1>
                                <div class="grafico g-barra">
                                    <canvas id="myChartBar"></canvas>
                                </div>

                                </div>

                            </div>

                        </div>

                    </div>

                    </div>

                </section>

                <script>

                    function toggleMenu() {
                        let subMenu = document.getElementById("sub-menu-wrap");
                        subMenu.classList.toggle("open-menu");
                    };

                    function pizzas() {
                        let estadoPizza = select_estado.value;

                        if (estadoPizza == "Lux") {
                            pizza_lux.style.display = "flex"
                            pizza_temp.style.display = "none"
                            pizza_umi.style.display = "none"
                        } else if (estadoPizza == "Temp") {
                            pizza_lux.style.display = "none"
                            pizza_temp.style.display = "flex"
                            pizza_umi.style.display = "none"
                        } else if (estadoPizza == "Umi") {
                            pizza_lux.style.display = "none"
                            pizza_temp.style.display = "none"
                            pizza_umi.style.display = "flex"
                        }
                    }

                   /* -- dht11 -- */
                   var contextoDht11 = document.getElementById('dht11').getContext('2d');
                    
                    var dht11Medidas = new Chart(
                        contextoDht11,
                        {
                            type: 'line',
                            data: {
                                labels: ['0:00', '1:00', '2:00', '3:00', '4:00', '5:00', '6:00', '7:00', '8:00', '9:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00', '19:00', '20:00', '21:00', '22:00', '23:00'],
                                datasets: [{
                                    label: 'Umidade',
                                    type: 'line',
                                    data: [60, 56, 52, 57, 66, 54, 58, 50, 52, 45, 47, 40, 41, 46, 47, 49, 53, 56, 60, 57, 52, 58, 60, 68],
                                    borderColor: ['#45b3e7'],
                                    backgroundColor: ['transparent'],
                                    borderWidth: 2

                                },
                                {
                                    label: 'Temperatura',
                                    type: 'line',
                                    data: [20, 20, 20, 20, 20, 20, 20, 21, 21, 21, 24, 26, 28, 27, 22, 21, 21, 20, 21, 20, 20, 20, 21, 20],
                                    borderColor: ['#fa2e30'],
                                    backgroundColor: ['transparent'],
                                    borderWidth: 2

                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                animation: {
                                    duration: 0
                                },
                                legend: {
                                    position: 'bottom'
                                }
                            }
                        }
                    );
                    /* -- luminosidade -- */
                    var contextoLuminosidade = document.getElementById('luminosidade').getContext('2d');
        
                    var luminosidade = new Chart(
                        contextoLuminosidade,
                        {
                            type: 'line',
                            data: {
                                labels: ['0:00', '1:00', '2:00', '3:00', '4:00', '5:00', '6:00', '7:00', '8:00', '9:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00', '19:00', '20:00', '21:00', '22:00', '23:00'],
                                datasets: [{
                                    label: 'Luminosidade',
                                    type: 'line',
                                    data: [80, 80, 80, 80, 80, 89, 100, 252, 294, 315, 450, 540, 550, 466, 310, 234, 190, 150, 120, 80, 80, 80, 80, 80],
                                    borderColor: ['#ffd902'],
                                    backgroundColor: ['transparent'],
                                    borderWidth: 2
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                animation: {
                                    duration: 0
                                },
                                legend: {
                                    position: 'bottom'
                                }
                            }
                        }
                    );
                    // gráfico média 
                    var contextoMedia = document.getElementById('myChartBar').getContext('2d');
                    var media = new Chart(
                        contextoMedia,
                        {
                            type: 'bar',
                            data: {
                                datasets: [{
                                    label: 'Segunda',
                                    type: 'bar',
                                    data: [6],
                                    borderColor: ['#45b3e7'],
                                    backgroundColor: ['#45b3e7'],
                                }, {
                                    label: 'Terça',
                                    type: 'bar',
                                    borderColor: ['#fa2e30'],
                                    data: [5],
                                    backgroundColor: ['#fa2e30']
                                }, {
                                    label: 'Quarta',
                                    type: 'bar',
                                    borderColor: ['#ffd902'],
                                    data: [7],
                                    backgroundColor: ['#ffd902']
                                }, {
                                    label: 'Quinta',
                                    type: 'bar',
                                    borderColor: ['#6995fd'],
                                    data: [5],
                                    backgroundColor: ['#6995fd']
                                }, {
                                    label: 'Sexta',
                                    type: 'bar',
                                    borderColor: ['#7aec9e'],
                                    data: [6],
                                    backgroundColor: ['#7aec9e']
                                }, {
                                    label: 'Sabádo',
                                    type: 'bar',
                                    borderColor: ['#f78fec'],
                                    data: [12],
                                    backgroundColor: ['#f78fec']
                                }, {
                                    label: 'Domingo',
                                    type: 'bar',
                                    borderColor: ['#f78fa4'],
                                    data: [11],
                                    backgroundColor: ['#f78fa4']
                                },
                                
                            ]},
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                animation: {
                                    duration: 0
                                },
                                legend: {
                                    position: 'bottom'
                                }
                            }
                        }
                    );
                    // gráfico pizza 
                    /* -- luminosidade -- */
                    var contextoPizzaLux = document.getElementById('pizzaLux').getContext('2d');
    
                    var estadoLux = new Chart(
                        contextoPizzaLux,
                        {
                            type: 'doughnut',
                            data: {
                                labels: [
                                'Bom', 'Ruim', 'Razoável',
                                ],
                                datasets: [{
                                    data: [14, 9, 1],
                                    type: 'doughnut',
                                    backgroundColor: ['#38ce67', '#bc3d3d', '#ffd902'],
                                }
                            ]},
                            hoverOffset: 4,
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                animation: {
                                    duration: 0,
                                },
                                legend: {
                                    position: 'bottom'
                                }
                            }
                        }
                    );

                    var contextoPizzaTemp = document.getElementById('pizzaTemp').getContext('2d');

                    var estadoTemp = new Chart(
                        contextoPizzaTemp,
                        {
                            type: 'doughnut',
                            data: {
                                labels: [
                                'Bom', 'Ruim', 'Razoável',
                                ],
                                datasets: [{
                                    data: [18, 4, 2],
                                    type: 'doughnut',
                                    backgroundColor: ['#38ce67', '#bc3d3d', '#ffd902'],
                                }
                            ]},
                            hoverOffset: 4,
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                animation: {
                                    duration: 0
                                },
                                legend: {
                                    position: 'bottom'
                                }
                            }
                        }
                    );

                    var contextoPizzaUmi = document.getElementById('pizzaUmi').getContext('2d');

                    var estadoUmi = new Chart(
                        contextoPizzaUmi,
                        {
                            type: 'doughnut',
                            data: {
                                labels: [
                                'Bom', 'Ruim', 'Razoável',
                                ],
                                datasets: [{
                                    data: [22, 0, 2],
                                    type: 'doughnut',
                                    backgroundColor: ['#38ce67', '#bc3d3d', '#ffd902'],
                                }
                            ]},
                            hoverOffset: 4,
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                animation: {
                                    duration: 0
                                },
                                legend: {
                                    position: 'bottom'
                                }
                            }
                        }
                    );
                    
                    

                    // var paginacao = {};
                    // var tempo = {};
                    // function obterDados(grafico, endpoint) {
                    //     var http = new XMLHttpRequest();
                    //     http.open('GET', 'http://localhost:3300/sensores/' + endpoint, false);
                    //     http.send(null);
                    //     var valores = JSON.parse(http.responseText);
                    //     if (paginacao[endpoint] == null) {
                    //         paginacao[endpoint] = 0;
                    //     }
                    //     if (tempo[endpoint] == null) {
                    //         tempo[endpoint] = 0;
                    //     }
                    //     // Exibir à partir do último elemento exibido anteriormente
                    //     var ultimaPaginacao = paginacao[endpoint];
                    //     paginacao[endpoint] = valores.length;
                    //     var valores = valores.slice(ultimaPaginacao);
                    //     valores.forEach((valor) => {
                    //         //Máximo de 60 itens exibidos no gráfico
                    //         if (grafico.data.labels.length == 10 && grafico.data.datasets[0].data.length == 10) {
                    //             grafico.data.labels.shift();
                    //             grafico.data.datasets[0].data.shift();
                    //         }

                    //         grafico.data.labels.push(tempo[endpoint]++);
                    //         grafico.data.datasets[0].data.push(parseFloat(valor));
                    //         grafico.update();
                    //     })
                    // }

                    // setInterval(() => {
                    //     obterDados(Umidade, 'dht11/umidade');
                    //     obterDados(Temperatura, 'dht11/temperatura');
                    //     obterDados(luminosidade, 'luminosidade');
                    // }, 1000);

                </script>