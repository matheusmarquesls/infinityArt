<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Simulador Financeiro</title>
    <link rel="stylesheet" href="style.css" />
  </head>

  <body>
    
    <header class="header-center">
      <nav class="header-nav">
          <ul class="header-ul">
              <li class="nav-logo"> 
                  <img class="logotipo" src="image/art-icon.png" alt="">
              </li>

              <li>
                  <a href="">
                      Página Inicial
                  </a>
              </li>

              <li>
                  <a href="">
                      Sobre Nós
                  </a>
              </li>

              <li>
                  <a href="">
                      Simulador<br>Financeiro
                  </a>
              </li>

              <li>
                  <a href="">
                      Fale<br>Conosco
                  </a>
              </li>
              <li class="nav-button">
                    
                  <a target="blank" href="login.html"><button class="login" onclick=""> Entrar </button></a>      
                  
                  <a target="blank" href="cadastro.html"><button class="cadastro" onclick=""> Cadastro </button> </a>       
                    
            </li>
          </ul>
      </nav>

</header>

    <!-- Delimitação de espaço (a calculadora tem que estar dentro desse limite) -->
    <div class="container">
      <!-- Div da calculadora toda (a parte branca de html) -->
      <div class="div_calculadora">
        <!-- Div onde aparece os tamanhos de referência e a imagem inicial-->
        <div class="div_orientacoes">
          <div class="texto">
            <!-- Imagem pequena que aparece quando aperta no botão calcular -->
            <img
              id="img_tex"
              class="img-tex"
              style="display: none"
              src="image/view.png"
            />

            <!-- Lista dos tamanhos de refência -->
            <b class="text-tam-b" id="texto_b"> Tamanhos de Referência: </b>

            <p class="text-tam-p" id="texto_p">
              Pequeno = Até 50cm <br />
              Médio = Entre 50cm e 150cm <br />
              Grande = Acima 150cm <br />
            </p>
          </div>

          <!-- Imagem inicial -->
          <img id="imagem" class="img-ori" src="image/view.png" />

          <!-- Div dos quadros azuis, onde o usuário vê suas obras-->
          <div class="div_view" id="div_quadradinhos"></div>
          <!-- Div da mensagem final da perda do usuário -->
          <div
            class="div_view_final"
            id="div_mensagem_final"
            style="display: none"
          ></div>
        </div>

        <!-- Linha divisória da calculadora -->
        <hr />

        <!-- Div do simulador financeiro -->
        <div class="div_componentes">
          <!-- Título -->
          <h1>Simule suas Economias</h1>
          <br />

          <!-- Inputs da calculadora -->

          <!-- Input sobre o preço das obras -->
          <input
            type="number"
            class="input_calculadora"
            id="input_precoObras"
            placeholder="Preço das Obras"
          />
          <br />

          <!-- Input sobre a quantidade de obras -->
          <input
            type="number"
            class="input_calculadora"
            id="input_qtd_obras"
            placeholder="Quantidade de Obras"
          />
          <br />

          <!-- Select sobre o tipo de tinta -->
          <select id="select_tipo_tinta" class="select_calculadora">
            <option value="#" selected disabled>
              Selecione o tipo de tinta
            </option>
            <option value="acrilica">Acrílica</option>
            <option value="guache">Guache</option>
            <option value="oleo">Óleo</option>
          </select>
          <br />

          <!-- Select sobre o tamanho da obra -->
          <select id="select_tam_obra" class="select_calculadora">
            <option value="#" selected disabled>Selecione o tamanho</option>
            <option value="pequeno">Pequeno</option>
            <option value="medio">Médio</option>
            <option value="grande">Grande</option>
          </select>
          <br />

          <!-- Div onde estão localizado os botões -->
          <div class="div_botoes">
            <!-- Botão de adicionar obras -->
            <button onclick="adicionarObra()" class="button_add">
              Adicionar
            </button>
            <!-- Botão para o calculo final -->
            <button
              onclick="calcPrejuizo()"
              id="botaoCalcular"
              class="button_calc"
              style="display: none"
            >
              Calcular
            </button>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>

<script>
  // Variaveis globais que calculam a perda do cliente por trás dos panos (Necessita-se de váriaveis globais pois é um valor calculado individualmente, e depois somado para condizer com o valor total do acervo do cliente)

  // valorTotalDoAcervo é a váriavel que SOMA o preço de cada quadradinho azul, para resultar no valor total do acervo do cliente
  let valorTotalDoAcervo = 0;
  // perdaEmRestauracao é a váriavel que CALCULA o preço da restaução
  let perdaEmRestauracao = 0;

  // contador que conta quantos quadradinhos o cliente adicionou para o calcúlo -- Não faz diferença na lógica, apenas estétic --
  let contador = 0;

  // Função adiconar obra, essa função CALCULA inidividualmente as obras que o cliente inserir quadradinhos (Mas não mostra ao cliente)
  function adicionarObra() {
    // Variáveis do Valor do Preco das Obras e Quantidade de Obras
    const precoObras = Number(input_precoObras.value);
    const qtdObras = Number(input_qtd_obras.value);

    // Modificando a váriavel para ela se atualizar toda vez que é inserido um novo quadradinho de obras
    valorTotalDoAcervo = valorTotalDoAcervo + precoObras;

    // Variáveis dos tipos de tintas usadas e dos tamanhos das obras
    const tipoTinta = select_tipo_tinta.value;
    const tamObra = select_tam_obra.value;

    // Variavel da validacao dos campos, onde todos os campos devem ser preenchidos para adicionar uma nova obra
    const validacao =
      tipoTinta == "#" || tamObra == "#" || precoObras <= 0 || qtdObras <= 0;

    // Caso algum campo esteja vazio, o código para e emiti um alerta de erro
    if (validacao) {
      alert(`ERRO: Insira os valores validos`);
    } else {
      // Quando o código roda o botão calcular aparece, caso o usúario queira finalizar o calculo
      botaoCalcular.style.display = "block";

      // É criado 2 váriaveis vazias, que mudam dependendo doque o usúario inserir (seram usadas para visualização dos quadradinhos)
      let variacaoTam;
      let variacaoTinta;

      // variacaoTam muda se o tamanho for Pequeno, Médio ou Grande
      if (tamObra == "pequeno") {
        variacaoTam = `Pequeno`;
      } else if (tamObra == "medio") {
        variacaoTam = `Médio`;
      } else {
        variacaoTam = `Grande`;
      }

      // variacaoTinta muda se o tipo da tinta for Acrílica, Guache ou Óleo
      if (tipoTinta == "acrilica") {
        variacaoTinta = `Acrílica`;
      } else if (tipoTinta == "guache") {
        variacaoTinta = `Guache`;
      } else {
        variacaoTinta = `Óleo`;
      }

      // Criando variáveis numéricas relacionadas a diferentes tintas e tamanho
      // Elas seram utilizadas nos calculos individuais, pois o preço pode váriar dependendo do tamanho ou tipo da tinta

      let adicionalTintaAcrilica = 0;
      let adicionalTintaGuache = 0;
      let adicionalTintaOleo = 0;

      let adicionalTamanhoPequeno = 0;
      let adicionalTamanhoMedio = 0;
      let adicionalTamanhoGrande = 0;

      // Dividindo a quantidade de obras inseridas pelo preço total dessas obras, para conseguir a média do preço unitário
      const precoUnitarioObras = precoObras / qtdObras;

      // As porcentagens que contem nos calculos são porcentagens assumidas pela equipe, devido a variação no custo das restaurações depedendo do preço da obras (como se fosse calculado a mão de obra)
      // Calculando preço adicional dependendo do tamanho -- Esse preço é calculado pelo preço médio unitário de cada obra --
      if (tamObra == "pequeno") {
        adicionalTamanhoPequeno = (precoUnitarioObras * 0.02 + 4000) * qtdObras;
      } else if (tamObra == "medio") {
        adicionalTamanhoMedio = (precoUnitarioObras * 0.035 + 14000) * qtdObras;
      } else if (tamObra == "grande") {
        adicionalTamanhoGrande = (precoUnitarioObras * 0.06 + 20000) * qtdObras;
      }
      // Calculando preço adicional dependendo do tipo da tinta -- Esse preço é calculado pelo preço médio unitário de cada obra --
      if (tipoTinta == "acrilica") {
        adicionalTintaAcrilica = precoUnitarioObras * 0.02;
      } else if (tipoTinta == "guache") {
        adicionalTintaGuache = precoUnitarioObras * 0.02;
      } else if (tipoTinta == "oleo") {
        adicionalTintaOleo = precoUnitarioObras * 0.02;
      }

      // Calculando preço que seria gasto em (MÉDIA) com restauração (Onde ocorre a soma de todos os adicionais)

      let precoMedioComRestauracao =
        adicionalTamanhoPequeno +
        adicionalTamanhoMedio +
        adicionalTamanhoGrande +
        adicionalTintaAcrilica +
        adicionalTintaOleo +
        adicionalTintaGuache;

      //   Onde é calculado o custo da restauração
      perdaEmRestauracao = perdaEmRestauracao + precoMedioComRestauracao;

      //   Conversão desse valor para porcentagem (regra de 3)
      const porcentagemDeGastoEmRestauracao = (
        (perdaEmRestauracao * 100) /
        valorTotalDoAcervo
      ).toFixed(1);

      //   Formatação dos valores que seram exibidos aos usuários
      const precoObrasFormatado = precoObras.toLocaleString("pt-BR", {
        style: "currency",
        currency: "BRL",
      });

      const valorTotalDoAcervoFormatado = valorTotalDoAcervo.toLocaleString(
        "pt-BR",
        {
          style: "currency",
          currency: "BRL",
        }
      );

      const perdaPatrimonialFormatada = (
        valorTotalDoAcervo * 0.25
      ).toLocaleString("pt-BR", { style: "currency", currency: "BRL" });

      //   Onde ocorre o aumento da váriavel contador (sempre de 1 em 1)
      contador++;

      //   Escondendo a imagem inicial da calculadora
      imagem.style.display = "none";

      //   Exibindo os quadradinhos azuais com as informações que o usuário inseriu
      div_quadradinhos.innerHTML += `

            <div id="div_resultado">

                <p>
            
                <b> ${contador} </b> 

                <br> Preço: <b> ${precoObrasFormatado} </b> <br> 

                Quantidade: <b> ${qtdObras} </b> <br> 
                
                Tinta: <b> ${variacaoTinta} </b> <br> 
                
                Tamanho: <b> ${variacaoTam} </b> <br>

                </p>

            </div>
            
            `;

      // Mensagem final do usuário, onde vai aparecer o valor total do acervo (que foi somado na váriavel global) a porcentagem de gasto com restauração (que é criada em cima do preço total do acervo) e a perda do patrimonio cultural
      div_mensagem_final.innerHTML = `

                <p>

                <b> Preço total do Acervo: </b> 
                <span style="color: blue"> <b> ${valorTotalDoAcervoFormatado} </b> </span>

                </p>

                <p>

                <br> <b> Perda em restaurações: </b>
                <span style="color: red;"> <b> ${porcentagemDeGastoEmRestauracao}% </b> </span> sobre o valor total do acervo
                
                </p>

                <p>

                <br> <b> Perda patrimonial: </b> Quando suas obras são reparadas, elas perdem cerca de <span style="color: red;"> <b> 25% </b> </span> do seu valor original. O que é equivalente à 
                <span style="color: red;"> <b> ${perdaPatrimonialFormatada} </b> </span>

                </p>

        `;

      //    Limpando os valores, para o cliente não apertar 2 vezes no mesmo valor e ter que resetar o calculo
      select_tipo_tinta.value = `#`;
      select_tam_obra.value = `#`;
      input_qtd_obras.value = ``;
      input_precoObras.value = ``;
    }
  }

  //   Função onde aparece os quadrdinhos se ocultam, e aparece a mensagem final pro usuário
  function calcPrejuizo() {
    div_quadradinhos.style.display = "none";
    div_mensagem_final.style.display = "block";
    texto_p.style.display = "none";
    texto_b.style.display = "none";
    img_tex.style.display = "block";
  }
</script>
